name: "Interactive Parameter Pipeline"

# on:
#   push:
#     branches:
#       - main   

jobs:
  first-stage:
    runs-on: ubuntu-latest
    steps:
      - name: Stage 1 - Echo message
        run: echo "Hello from Stage 1!"

  second-stage:
    runs-on: ubuntu-latest
    needs: first-stage
    outputs:
      param1: ${{ steps.interactive-inputs.outputs.param1 }}
      param2: ${{ steps.interactive-inputs.outputs.param2 }}
      param3: ${{ steps.interactive-inputs.outputs.param3 }}
      param4: ${{ steps.interactive-inputs.outputs.param4 }}
      param5: ${{ steps.interactive-inputs.outputs.param5 }}
    permissions:
      contents: write
    steps:
      - name: Stage 2 - Ask for parameters interactively
        id: interactive-inputs
        uses: boasihq/interactive-inputs@v2
        with:
          ngrok-authtoken: ${{ secrets.NGROK_AUTHTOKEN }}
          notifier-slack-enabled: "false"
          notifier-discord-enabled: "false"
          timeout: 300
          title: "Please provide 5 parameters"
          interactive: |
            fields:
              - label: param1
                properties:
                  display: Parameter 1
                  type: text
                  required: true
              - label: param2
                properties:
                  display: Parameter 2
                  type: text
                  required: true
              - label: param3
                properties:
                  display: Parameter 3
                  type: text
                  required: true
              - label: param4
                properties:
                  display: Parameter 4
                  type: text
                  required: true
              - label: param5
                properties:
                  display: Parameter 5
                  type: text
                  required: true

  third-stage:
    runs-on: ubuntu-latest
    needs: second-stage
    steps:
      - name: Stage 3 - Print parameters
        run: |
          echo "You entered:"
          echo "Parameter 1: ${{ needs.second-stage.outputs.param1 }}"
          echo "Parameter 2: ${{ needs.second-stage.outputs.param2 }}"
          echo "Parameter 3: ${{ needs.second-stage.outputs.param3 }}"
          echo "Parameter 4: ${{ needs.second-stage.outputs.param4 }}"
          echo "Parameter 5: ${{ needs.second-stage.outputs.param5 }}"
